<%= stylesheet_link_tag "inbox", "data-turbo-track": "reload" %>



<div id="chat-id" data-chat-id="<%= @chat.id %>"></div>
<div id="user-id" data-user-id="<%= Current.user.id %>"></div>

<div class="row messaging">
  
  <div class="col left-bar border">
    <%= render 'shared/message_list' %>
  </div>

  <div class="col-9 right-bar border">
    <nav class="navbar border-bottom">
      <div class="container-fluid">
        <a class="navbar-brand" href="#">
          <% if Current.user == @chat.user && @chat.user2.avatar.present? %>
            <%= image_tag(User.find(@chat.user2.id).avatar, class: "rounded-circle ", size: "45x45") + " @#{@chat.user2.username}" %>
          <% elsif Current.user == @chat.user2 && @chat.user.avatar.present? %>
            <%= image_tag(@chat.user.avatar, class: "rounded-circle ", size: "45x45") + " @#{@chat.user.username}" %>
          <% elsif Current.user == @chat.user %>
            <svg xmlns="http://www.w3.org/2000/svg" width="45" height="45" fill="currentColor" class="bi bi-person-circle" viewBox="0 0 16 16">
              <path d="M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0"/>
              <path fill-rule="evenodd" d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8m8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1"/>
            </svg>
            @<%= @chat.user2.username %>
          <% else %>
            <svg xmlns="http://www.w3.org/2000/svg" width="45" height="45" fill="currentColor" class="bi bi-person-circle" viewBox="0 0 16 16">
              <path d="M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0"/>
              <path fill-rule="evenodd" d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8m8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1"/>
            </svg>
            @<%= @chat.user.username %>
          <% end %>
        </a>
      </div>
      
    </nav>
    
   
    <div class="chat-room scrollarea">
      
      <div id="messages">
        <% @chat.messages.each do |message| %>
          <%= render 'messages/message', message: message %>
        <% end %>
      </div>
    </div>


    <div class="row border">
      <div class="chat-box p-2 col align-self-end">
          <%= render 'messages/form', message: Message.new, user: @user, chat: @chat %>
      </div>
    </div>
  </div>
</div>


